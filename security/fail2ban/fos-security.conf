# Fail2Ban filter for FOS-Streaming security events
# Monitors security.log for malicious activity
#
# Installation:
# cp fos-security.conf /etc/fail2ban/filter.d/
# systemctl restart fail2ban

[Definition]

# Match any security event with IP
failregex = ^\[.*?\] SECURITY EVENT: .* - IP: <HOST>

# Match specific attack patterns
            ^\[.*?\] SECURITY EVENT: Possible SQL injection .* - IP: <HOST>
            ^\[.*?\] SECURITY EVENT: Possible XSS .* - IP: <HOST>
            ^\[.*?\] SECURITY EVENT: CSRF .* - IP: <HOST>
            ^\[.*?\] SECURITY EVENT: Rate limit .* - IP: <HOST>
            ^\[.*?\] SECURITY EVENT: SUSPICIOUS .* - IP: <HOST>

# Ignore informational events
ignoreregex = Password upgraded|Password rehashed

datepattern = ^[[]%%Y-%%m-%%d %%H:%%M:%%S[]]
