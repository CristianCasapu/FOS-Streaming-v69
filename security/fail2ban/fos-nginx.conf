# Fail2Ban filter for FOS-Streaming nginx errors
# Monitors nginx error.log for suspicious activity
#
# Installation:
# cp fos-nginx.conf /etc/fail2ban/filter.d/
# systemctl restart fail2ban

[Definition]

# Match 403 (Forbidden)
failregex = ^<HOST> .* "(?:GET|POST|HEAD) .* HTTP/.*" 403

# Match 404 scanning
            ^<HOST> .* "(?:GET|POST|HEAD) .*(?:\.php|\.asp|\.exe|\.dll|\.cgi|admin|phpmyadmin|wp-admin) .* HTTP/.*" 404

# Match suspicious user agents
            ^<HOST> .* ".*(?:nikto|sqlmap|nmap|masscan|nessus|openvas|metasploit).*" \d+ \d+

# Match directory traversal attempts
            ^<HOST> .* ".*\.\./.*" \d+ \d+

# Match script injection attempts
            ^<HOST> .* ".*(?:<script|javascript:|<iframe|eval\(|base64_decode).*" \d+ \d+

# Match excessive 400 errors (bad requests)
            ^<HOST> .* .* HTTP/.*" 400

ignoreregex =
