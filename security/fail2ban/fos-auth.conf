# Fail2Ban filter for FOS-Streaming authentication
# Monitors auth.log for failed login attempts
#
# Installation:
# cp fos-auth.conf /etc/fail2ban/filter.d/
# systemctl restart fail2ban

[Definition]

# Match failed login attempts in auth.log
# Format: [2025-11-21 14:23:45] Auth FAILED - User: admin, IP: 192.168.1.100
failregex = ^\[.*?\] Auth FAILED - User: .*, IP: <HOST>

# Match CSRF validation failures
            ^\[.*?\] SECURITY EVENT: CSRF token validation failed - IP: <HOST>

# Match rate limit exceeded
            ^\[.*?\] SECURITY EVENT: Rate limit exceeded - IP: <HOST>

# Match suspicious activity
            ^\[.*?\] SECURITY EVENT: SUSPICIOUS: .* - IP: <HOST>

# Match SQL injection attempts
            ^\[.*?\] SECURITY EVENT: Possible SQL injection attempt - IP: <HOST>

# Match XSS attempts
            ^\[.*?\] SECURITY EVENT: Possible XSS attempt - IP: <HOST>

# Ignore successful logins
ignoreregex = Auth SUCCESS

# Date pattern (optional, fail2ban will auto-detect)
datepattern = ^[[]%%Y-%%m-%%d %%H:%%M:%%S[]]
